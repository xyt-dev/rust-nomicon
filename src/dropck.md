# Ɖʀօք Ƈɦɛƈӄ

Ɯɛ ɦǟʋɛ ֆɛɛռ ɦօա ʟɨʄɛȶɨʍɛֆ քʀօʋɨɖɛ ʊֆ ֆօʍɛ ʄǟɨʀʟʏ ֆɨʍքʟɛ ʀʊʟɛֆ ʄօʀ ɛռֆʊʀɨռɢ
ȶɦǟȶ աɛ ռɛʋɛʀ ʀɛǟɖ ɖǟռɢʟɨռɢ ʀɛʄɛʀɛռƈɛֆ. Ӈօաɛʋɛʀ ʊք ȶօ ȶɦɨֆ քօɨռȶ աɛ ɦǟʋɛ օռʟʏ ɛʋɛʀ
ɨռȶɛʀǟƈȶɛɖ աɨȶɦ ȶɦɛ _օʊȶʟɨʋɛֆ_ ʀɛʟǟȶɨօռֆɦɨք ɨռ ǟռ ɨռƈʟʊֆɨʋɛ ʍǟռռɛʀ. Ƭɦǟȶ ɨֆ,
աɦɛռ աɛ ȶǟʟӄɛɖ ǟɮօʊȶ `'ǟ: 'ɮ`, ɨȶ աǟֆ օӄ ʄօʀ `'ǟ` ȶօ ʟɨʋɛ _ɛӼǟƈȶʟʏ_ ǟֆ ʟօռɢ ǟֆ
`'ɮ`. Ǟȶ ʄɨʀֆȶ ɢʟǟռƈɛ, ȶɦɨֆ ֆɛɛʍֆ ȶօ ɮɛ ǟ ʍɛǟռɨռɢʟɛֆֆ ɖɨֆȶɨռƈȶɨօռ. Ռօȶɦɨռɢ ɛʋɛʀ
ɢɛȶֆ ɖʀօքքɛɖ ǟȶ ȶɦɛ ֆǟʍɛ ȶɨʍɛ ǟֆ ǟռօȶɦɛʀ, ʀɨɢɦȶ? Ƭɦɨֆ ɨֆ աɦʏ աɛ ʊֆɛɖ ȶɦɛ
ʄօʟʟօաɨռɢ ɖɛֆʊɢǟʀɨռɢ օʄ `ʟɛȶ` ֆȶǟȶɛʍɛռȶֆ:

<!-- ignore: simplified code -->
```rust,ignore
let x;
let y;
```

ɖɛֆʊɢǟʀɨռɢ ȶօ:

<!-- ignore: desugared code -->
```rust,ignore
{
    let x;
    {
        let y;
    }
}
```

Ƭɦɛʀɛ ǟʀɛ ֆօʍɛ ʍօʀɛ ƈօʍքʟɛӼ ֆɨȶʊǟȶɨօռֆ աɦɨƈɦ ǟʀɛ ռօȶ քօֆֆɨɮʟɛ ȶօ ɖɛֆʊɢǟʀ ʊֆɨռɢ
ֆƈօքɛֆ, ɮʊȶ ȶɦɛ օʀɖɛʀ ɨֆ ֆȶɨʟʟ ɖɛʄɨռɛɖ ‒ ʋǟʀɨǟɮʟɛֆ ǟʀɛ ɖʀօքքɛɖ ɨռ ȶɦɛ ʀɛʋɛʀֆɛ
օʀɖɛʀ օʄ ȶɦɛɨʀ ɖɛʄɨռɨȶɨօռ, ʄɨɛʟɖֆ օʄ ֆȶʀʊƈȶֆ ǟռɖ ȶʊքʟɛֆ ɨռ օʀɖɛʀ օʄ ȶɦɛɨʀ
ɖɛʄɨռɨȶɨօռ. Ƭɦɛʀɛ ǟʀɛ ֆօʍɛ ʍօʀɛ ɖɛȶǟɨʟֆ ǟɮօʊȶ օʀɖɛʀ օʄ ɖʀօք ɨռ [ƦƑƇ 1857][ʀʄƈ1857].

Łɛȶ'ֆ ɖօ ȶɦɨֆ:

<!-- ignore: simplified code -->
```rust,ignore
let tuple = (vec![], vec![]);
```

Ƭɦɛ ʟɛʄȶ ʋɛƈȶօʀ ɨֆ ɖʀօքքɛɖ ʄɨʀֆȶ. Ɓʊȶ ɖօɛֆ ɨȶ ʍɛǟռ ȶɦɛ ʀɨɢɦȶ օռɛ ֆȶʀɨƈȶʟʏ
օʊȶʟɨʋɛֆ ɨȶ ɨռ ȶɦɛ ɛʏɛֆ օʄ ȶɦɛ ɮօʀʀօա ƈɦɛƈӄɛʀ? Ƭɦɛ ǟռֆաɛʀ ȶօ ȶɦɨֆ զʊɛֆȶɨօռ ɨֆ
_ռօ_. Ƭɦɛ ɮօʀʀօա ƈɦɛƈӄɛʀ ƈօʊʟɖ ȶʀǟƈӄ ʄɨɛʟɖֆ օʄ ȶʊքʟɛֆ ֆɛքǟʀǟȶɛʟʏ, ɮʊȶ ɨȶ աօʊʟɖ
ֆȶɨʟʟ ɮɛ ʊռǟɮʟɛ ȶօ ɖɛƈɨɖɛ աɦǟȶ օʊȶʟɨʋɛֆ աɦǟȶ ɨռ ƈǟֆɛ օʄ ʋɛƈȶօʀ ɛʟɛʍɛռȶֆ, աɦɨƈɦ
ǟʀɛ ɖʀօքքɛɖ ʍǟռʊǟʟʟʏ ʋɨǟ քʊʀɛ-ʟɨɮʀǟʀʏ ƈօɖɛ ȶɦɛ ɮօʀʀօա ƈɦɛƈӄɛʀ ɖօɛֆռ'ȶ
ʊռɖɛʀֆȶǟռɖ.

Ֆօ աɦʏ ɖօ աɛ ƈǟʀɛ? Ɯɛ ƈǟʀɛ ɮɛƈǟʊֆɛ ɨʄ ȶɦɛ ȶʏքɛ ֆʏֆȶɛʍ ɨֆռ'ȶ ƈǟʀɛʄʊʟ, ɨȶ ƈօʊʟɖ
ǟƈƈɨɖɛռȶǟʟʟʏ ʍǟӄɛ ɖǟռɢʟɨռɢ քօɨռȶɛʀֆ. Ƈօռֆɨɖɛʀ ȶɦɛ ʄօʟʟօաɨռɢ ֆɨʍքʟɛ քʀօɢʀǟʍ:

```rust
struct Inspector<'a>(&'a u8);

struct World<'a> {
    inspector: Option<Inspector<'a>>,
    days: Box<u8>,
}

fn main() {
    let mut world = World {
        inspector: None,
        days: Box::new(1),
    };
    world.inspector = Some(Inspector(&world.days));
}
```

Ƭɦɨֆ քʀօɢʀǟʍ ɨֆ ȶօȶǟʟʟʏ ֆօʊռɖ ǟռɖ ƈօʍքɨʟɛֆ ȶօɖǟʏ. Ƭɦɛ ʄǟƈȶ ȶɦǟȶ `ɖǟʏֆ` ɖօɛֆ ռօȶ
ֆȶʀɨƈȶʟʏ օʊȶʟɨʋɛ `ɨռֆքɛƈȶօʀ` ɖօɛֆռ'ȶ ʍǟȶȶɛʀ. Ǟֆ ʟօռɢ ǟֆ ȶɦɛ `ɨռֆքɛƈȶօʀ` ɨֆ
ǟʟɨʋɛ, ֆօ ɨֆ `ɖǟʏֆ`.

Ӈօաɛʋɛʀ ɨʄ աɛ ǟɖɖ ǟ ɖɛֆȶʀʊƈȶօʀ, ȶɦɛ քʀօɢʀǟʍ աɨʟʟ ռօ ʟօռɢɛʀ ƈօʍքɨʟɛ!

```rust,compile_fail
struct Inspector<'a>(&'a u8);

impl<'a> Drop for Inspector<'a> {
    fn drop(&mut self) {
        println!("I was only {} days from retirement!", self.0);
    }
}

struct World<'a> {
    inspector: Option<Inspector<'a>>,
    days: Box<u8>,
}

fn main() {
    let mut world = World {
        inspector: None,
        days: Box::new(1),
    };
    world.inspector = Some(Inspector(&world.days));
    // Let's say `days` happens to get dropped first.
    // Then when Inspector is dropped, it will try to read free'd memory!
}
```

```text
error[E0597]: `world.days` does not live long enough
  --> src/main.rs:19:38
   |
19 |     world.inspector = Some(Inspector(&world.days));
   |                                      ^^^^^^^^^^^ borrowed value does not live long enough
...
22 | }
   | -
   | |
   | `world.days` dropped here while still borrowed
   | borrow might be used here, when `world` is dropped and runs the destructor for type `World<'_>`
```

Ƴօʊ ƈǟռ ȶʀʏ ƈɦǟռɢɨռɢ ȶɦɛ օʀɖɛʀ օʄ ʄɨɛʟɖֆ օʀ ʊֆɛ ǟ ȶʊքʟɛ ɨռֆȶɛǟɖ օʄ ȶɦɛ ֆȶʀʊƈȶ,
ɨȶ'ʟʟ ֆȶɨʟʟ ռօȶ ƈօʍքɨʟɛ.

Ɨʍքʟɛʍɛռȶɨռɢ `Ɖʀօք` ʟɛȶֆ ȶɦɛ `Ɨռֆքɛƈȶօʀ` ɛӼɛƈʊȶɛ ֆօʍɛ ǟʀɮɨȶʀǟʀʏ ƈօɖɛ ɖʊʀɨռɢ ɨȶֆ
ɖɛǟȶɦ. Ƭɦɨֆ ʍɛǟռֆ ɨȶ ƈǟռ քօȶɛռȶɨǟʟʟʏ օɮֆɛʀʋɛ ȶɦǟȶ ȶʏքɛֆ ȶɦǟȶ ǟʀɛ ֆʊքքօֆɛɖ ȶօ
ʟɨʋɛ ǟֆ ʟօռɢ ǟֆ ɨȶ ɖօɛֆ ǟƈȶʊǟʟʟʏ աɛʀɛ ɖɛֆȶʀօʏɛɖ ʄɨʀֆȶ.

Ɨռȶɛʀɛֆȶɨռɢʟʏ, օռʟʏ ɢɛռɛʀɨƈ ȶʏքɛֆ ռɛɛɖ ȶօ աօʀʀʏ ǟɮօʊȶ ȶɦɨֆ. Ɨʄ ȶɦɛʏ ǟʀɛռ'ȶ
ɢɛռɛʀɨƈ, ȶɦɛռ ȶɦɛ օռʟʏ ʟɨʄɛȶɨʍɛֆ ȶɦɛʏ ƈǟռ ɦǟʀɮօʀ ǟʀɛ `'ֆȶǟȶɨƈ`, աɦɨƈɦ աɨʟʟ ȶʀʊʟʏ
ʟɨʋɛ _ʄօʀɛʋɛʀ_. Ƭɦɨֆ ɨֆ աɦʏ ȶɦɨֆ քʀօɮʟɛʍ ɨֆ ʀɛʄɛʀʀɛɖ ȶօ ǟֆ _ֆօʊռɖ ɢɛռɛʀɨƈ ɖʀօք_.
Ֆօʊռɖ ɢɛռɛʀɨƈ ɖʀօք ɨֆ ɛռʄօʀƈɛɖ ɮʏ ȶɦɛ _ɖʀօք ƈɦɛƈӄɛʀ_. Ǟֆ օʄ ȶɦɨֆ աʀɨȶɨռɢ, ֆօʍɛ
օʄ ȶɦɛ ʄɨռɛʀ ɖɛȶǟɨʟֆ օʄ ɦօա ȶɦɛ ɖʀօք ƈɦɛƈӄɛʀ (ǟʟֆօ ƈǟʟʟɛɖ ɖʀօքƈӄ) ʋǟʟɨɖǟȶɛֆ
ȶʏքɛֆ ɨֆ ȶօȶǟʟʟʏ ʊք ɨռ ȶɦɛ ǟɨʀ. Ӈօաɛʋɛʀ Ƭɦɛ Ɓɨɢ Ʀʊʟɛ ɨֆ ȶɦɛ ֆʊɮȶʟɛȶʏ ȶɦǟȶ աɛ
ɦǟʋɛ ʄօƈʊֆɛɖ օռ ȶɦɨֆ աɦօʟɛ ֆɛƈȶɨօռ:

**Ƒօʀ ǟ ɢɛռɛʀɨƈ ȶʏքɛ ȶօ ֆօʊռɖʟʏ ɨʍքʟɛʍɛռȶ ɖʀօք, ɨȶֆ ɢɛռɛʀɨƈֆ ǟʀɢʊʍɛռȶֆ ʍʊֆȶ
ֆȶʀɨƈȶʟʏ օʊȶʟɨʋɛ ɨȶ.**

Øɮɛʏɨռɢ ȶɦɨֆ ʀʊʟɛ ɨֆ (ʊֆʊǟʟʟʏ) ռɛƈɛֆֆǟʀʏ ȶօ ֆǟȶɨֆʄʏ ȶɦɛ ɮօʀʀօա
ƈɦɛƈӄɛʀ; օɮɛʏɨռɢ ɨȶ ɨֆ ֆʊʄʄɨƈɨɛռȶ ɮʊȶ ռօȶ ռɛƈɛֆֆǟʀʏ ȶօ ɮɛ
ֆօʊռɖ. Ƭɦǟȶ ɨֆ, ɨʄ ʏօʊʀ ȶʏքɛ օɮɛʏֆ ȶɦɨֆ ʀʊʟɛ ȶɦɛռ ɨȶ'ֆ ɖɛʄɨռɨȶɛʟʏ
ֆօʊռɖ ȶօ ɖʀօք.

Ƭɦɛ ʀɛǟֆօռ ȶɦǟȶ ɨȶ ɨֆ ռօȶ ǟʟաǟʏֆ ռɛƈɛֆֆǟʀʏ ȶօ ֆǟȶɨֆʄʏ ȶɦɛ ǟɮօʋɛ ʀʊʟɛ
ɨֆ ȶɦǟȶ ֆօʍɛ Ɖʀօք ɨʍքʟɛʍɛռȶǟȶɨօռֆ աɨʟʟ ռօȶ ǟƈƈɛֆֆ ɮօʀʀօաɛɖ ɖǟȶǟ ɛʋɛռ
ȶɦօʊɢɦ ȶɦɛɨʀ ȶʏքɛ ɢɨʋɛֆ ȶɦɛʍ ȶɦɛ ƈǟքǟɮɨʟɨȶʏ ʄօʀ ֆʊƈɦ ǟƈƈɛֆֆ, օʀ ɮɛƈǟʊֆɛ աɛ ӄռօա
ȶɦɛ ֆքɛƈɨʄɨƈ ɖʀօք օʀɖɛʀ ǟռɖ ȶɦɛ ɮօʀʀօաɛɖ ɖǟȶǟ ɨֆ ֆȶɨʟʟ ʄɨռɛ ɛʋɛռ ɨʄ ȶɦɛ ɮօʀʀօա
ƈɦɛƈӄɛʀ ɖօɛֆռ'ȶ ӄռօա ȶɦǟȶ.

Ƒօʀ ɛӼǟʍքʟɛ, ȶɦɨֆ ʋǟʀɨǟռȶ օʄ ȶɦɛ ǟɮօʋɛ `Ɨռֆքɛƈȶօʀ` ɛӼǟʍքʟɛ աɨʟʟ ռɛʋɛʀ
ǟƈƈɛֆֆ ɮօʀʀօաɛɖ ɖǟȶǟ:

```rust,compile_fail
struct Inspector<'a>(&'a u8, &'static str);

impl<'a> Drop for Inspector<'a> {
    fn drop(&mut self) {
        println!("Inspector(_, {}) knows when *not* to inspect.", self.1);
    }
}

struct World<'a> {
    inspector: Option<Inspector<'a>>,
    days: Box<u8>,
}

fn main() {
    let mut world = World {
        inspector: None,
        days: Box::new(1),
    };
    world.inspector = Some(Inspector(&world.days, "gadget"));
    // Let's say `days` happens to get dropped first.
    // Even when Inspector is dropped, its destructor will not access the
    // borrowed `days`.
}
```

Łɨӄɛաɨֆɛ, ȶɦɨֆ ʋǟʀɨǟռȶ աɨʟʟ ǟʟֆօ ռɛʋɛʀ ǟƈƈɛֆֆ ɮօʀʀօաɛɖ ɖǟȶǟ:

```rust,compile_fail
struct Inspector<T>(T, &'static str);

impl<T> Drop for Inspector<T> {
    fn drop(&mut self) {
        println!("Inspector(_, {}) knows when *not* to inspect.", self.1);
    }
}

struct World<T> {
    inspector: Option<Inspector<T>>,
    days: Box<u8>,
}

fn main() {
    let mut world = World {
        inspector: None,
        days: Box::new(1),
    };
    world.inspector = Some(Inspector(&world.days, "gadget"));
    // Let's say `days` happens to get dropped first.
    // Even when Inspector is dropped, its destructor will not access the
    // borrowed `days`.
}
```

Ӈօաɛʋɛʀ, _ɮօȶɦ_ օʄ ȶɦɛ ǟɮօʋɛ ʋǟʀɨǟռȶֆ ǟʀɛ ʀɛʝɛƈȶɛɖ ɮʏ ȶɦɛ ɮօʀʀօա
ƈɦɛƈӄɛʀ ɖʊʀɨռɢ ȶɦɛ ǟռǟʟʏֆɨֆ օʄ `ʄռ ʍǟɨռ`, ֆǟʏɨռɢ ȶɦǟȶ `ɖǟʏֆ` ɖօɛֆ ռօȶ
ʟɨʋɛ ʟօռɢ ɛռօʊɢɦ.

Ƭɦɛ ʀɛǟֆօռ ɨֆ ȶɦǟȶ ȶɦɛ ɮօʀʀօա ƈɦɛƈӄɨռɢ ǟռǟʟʏֆɨֆ օʄ `ʍǟɨռ` ɖօɛֆ ռօȶ
ӄռօա ǟɮօʊȶ ȶɦɛ ɨռȶɛʀռǟʟֆ օʄ ɛǟƈɦ `Ɨռֆքɛƈȶօʀ`'ֆ `Ɖʀօք` ɨʍքʟɛʍɛռȶǟȶɨօռ. Ǟֆ
ʄǟʀ ǟֆ ȶɦɛ ɮօʀʀօա ƈɦɛƈӄɛʀ ӄռօաֆ աɦɨʟɛ ɨȶ ɨֆ ǟռǟʟʏʐɨռɢ `ʍǟɨռ`, ȶɦɛ ɮօɖʏ
օʄ ǟռ ɨռֆքɛƈȶօʀ'ֆ ɖɛֆȶʀʊƈȶօʀ ʍɨɢɦȶ ǟƈƈɛֆֆ ȶɦǟȶ ɮօʀʀօաɛɖ ɖǟȶǟ.

Ƭɦɛʀɛʄօʀɛ, ȶɦɛ ɖʀօք ƈɦɛƈӄɛʀ ʄօʀƈɛֆ ǟʟʟ ɮօʀʀօաɛɖ ɖǟȶǟ ɨռ ǟ ʋǟʟʊɛ ȶօ
ֆȶʀɨƈȶʟʏ օʊȶʟɨʋɛ ȶɦǟȶ ʋǟʟʊɛ.

## Ǟռ Ɛֆƈǟքɛ Ӈǟȶƈɦ

Ƭɦɛ քʀɛƈɨֆɛ ʀʊʟɛֆ ȶɦǟȶ ɢօʋɛʀռ ɖʀօք ƈɦɛƈӄɨռɢ ʍǟʏ ɮɛ ʟɛֆֆ ʀɛֆȶʀɨƈȶɨʋɛ ɨռ
ȶɦɛ ʄʊȶʊʀɛ.

Ƭɦɛ ƈʊʀʀɛռȶ ǟռǟʟʏֆɨֆ ɨֆ ɖɛʟɨɮɛʀǟȶɛʟʏ ƈօռֆɛʀʋǟȶɨʋɛ; ɨȶ ʄօʀƈɛֆ ǟʟʟ
ɮօʀʀօաɛɖ ɖǟȶǟ ɨռ ǟ ʋǟʟʊɛ ȶօ օʊȶʟɨʋɛ ȶɦǟȶ ʋǟʟʊɛ, աɦɨƈɦ ɨֆ ƈɛʀȶǟɨռʟʏ ֆօʊռɖ.

Ƒʊȶʊʀɛ ʋɛʀֆɨօռֆ օʄ ȶɦɛ ʟǟռɢʊǟɢɛ ʍǟʏ ʍǟӄɛ ȶɦɛ ǟռǟʟʏֆɨֆ ʍօʀɛ քʀɛƈɨֆɛ, ȶօ
ʀɛɖʊƈɛ ȶɦɛ ռʊʍɮɛʀ օʄ ƈǟֆɛֆ աɦɛʀɛ ֆօʊռɖ ƈօɖɛ ɨֆ ʀɛʝɛƈȶɛɖ ǟֆ ʊռֆǟʄɛ.
Ƭɦɨֆ աօʊʟɖ ɦɛʟք ǟɖɖʀɛֆֆ ƈǟֆɛֆ ֆʊƈɦ ǟֆ ȶɦɛ ȶաօ `Ɨռֆքɛƈȶօʀ`ֆ ǟɮօʋɛ ȶɦǟȶ
ӄռօա ռօȶ ȶօ ɨռֆքɛƈȶ ɖʊʀɨռɢ ɖɛֆȶʀʊƈȶɨօռ.

Ɨռ ȶɦɛ ʍɛǟռȶɨʍɛ, ȶɦɛʀɛ ɨֆ ǟռ ʊռֆȶǟɮʟɛ ǟȶȶʀɨɮʊȶɛ ȶɦǟȶ օռɛ ƈǟռ ʊֆɛ ȶօ
ǟֆֆɛʀȶ (ʊռֆǟʄɛʟʏ) ȶɦǟȶ ǟ ɢɛռɛʀɨƈ ȶʏքɛ'ֆ ɖɛֆȶʀʊƈȶօʀ ɨֆ _ɢʊǟʀǟռȶɛɛɖ_ ȶօ
ռօȶ ǟƈƈɛֆֆ ǟռʏ ɛӼքɨʀɛɖ ɖǟȶǟ, ɛʋɛռ ɨʄ ɨȶֆ ȶʏքɛ ɢɨʋɛֆ ɨȶ ȶɦɛ ƈǟքǟɮɨʟɨȶʏ
ȶօ ɖօ ֆօ.

Ƭɦǟȶ ǟȶȶʀɨɮʊȶɛ ɨֆ ƈǟʟʟɛɖ `ʍǟʏ_ɖǟռɢʟɛ` ǟռɖ աǟֆ ɨռȶʀօɖʊƈɛɖ ɨռ [ƦƑƇ 1327][ʀʄƈ1327].
Ƭօ ɖɛքʟօʏ ɨȶ օռ ȶɦɛ `Ɨռֆքɛƈȶօʀ` ʄʀօʍ ǟɮօʋɛ, աɛ աօʊʟɖ աʀɨȶɛ:

```rust
#![feature(dropck_eyepatch)]

struct Inspector<'a>(&'a u8, &'static str);

unsafe impl<#[may_dangle] 'a> Drop for Inspector<'a> {
    fn drop(&mut self) {
        println!("Inspector(_, {}) knows when *not* to inspect.", self.1);
    }
}

struct World<'a> {
    days: Box<u8>,
    inspector: Option<Inspector<'a>>,
}

fn main() {
    let mut world = World {
        inspector: None,
        days: Box::new(1),
    };
    world.inspector = Some(Inspector(&world.days, "gadget"));
}
```

Ʊֆɛ օʄ ȶɦɨֆ ǟȶȶʀɨɮʊȶɛ ʀɛզʊɨʀɛֆ ȶɦɛ `Ɖʀօք` ɨʍքʟ ȶօ ɮɛ ʍǟʀӄɛɖ `ʊռֆǟʄɛ` ɮɛƈǟʊֆɛ ȶɦɛ
ƈօʍքɨʟɛʀ ɨֆ ռօȶ ƈɦɛƈӄɨռɢ ȶɦɛ ɨʍքʟɨƈɨȶ ǟֆֆɛʀȶɨօռ ȶɦǟȶ ռօ քօȶɛռȶɨǟʟʟʏ ɛӼքɨʀɛɖ ɖǟȶǟ
(ɛ.ɢ. `ֆɛʟʄ.0` ǟɮօʋɛ) ɨֆ ǟƈƈɛֆֆɛɖ.

Ƭɦɛ ǟȶȶʀɨɮʊȶɛ ƈǟռ ɮɛ ǟքքʟɨɛɖ ȶօ ǟռʏ ռʊʍɮɛʀ օʄ ʟɨʄɛȶɨʍɛ ǟռɖ ȶʏքɛ քǟʀǟʍɛȶɛʀֆ. Ɨռ
ȶɦɛ ʄօʟʟօաɨռɢ ɛӼǟʍքʟɛ, աɛ ǟֆֆɛʀȶ ȶɦǟȶ աɛ ǟƈƈɛֆֆ ռօ ɖǟȶǟ ɮɛɦɨռɖ ǟ ʀɛʄɛʀɛռƈɛ օʄ
ʟɨʄɛȶɨʍɛ `'ɮ` ǟռɖ ȶɦǟȶ ȶɦɛ օռʟʏ ʊֆɛֆ օʄ `Ƭ` աɨʟʟ ɮɛ ʍօʋɛֆ օʀ ɖʀօքֆ, ɮʊȶ օʍɨȶ
ȶɦɛ ǟȶȶʀɨɮʊȶɛ ʄʀօʍ `'ǟ` ǟռɖ `Ʊ`, ɮɛƈǟʊֆɛ աɛ ɖօ ǟƈƈɛֆֆ ɖǟȶǟ աɨȶɦ ȶɦǟȶ ʟɨʄɛȶɨʍɛ
ǟռɖ ȶɦǟȶ ȶʏքɛ:

```rust
#![feature(dropck_eyepatch)]
use std::fmt::Display;

struct Inspector<'a, 'b, T, U: Display>(&'a u8, &'b u8, T, U);

unsafe impl<'a, #[may_dangle] 'b, #[may_dangle] T, U: Display> Drop for Inspector<'a, 'b, T, U> {
    fn drop(&mut self) {
        println!("Inspector({}, _, _, {})", self.0, self.3);
    }
}
```

Ɨȶ ɨֆ ֆօʍɛȶɨʍɛֆ օɮʋɨօʊֆ ȶɦǟȶ ռօ ֆʊƈɦ ǟƈƈɛֆֆ ƈǟռ օƈƈʊʀ, ʟɨӄɛ ȶɦɛ ƈǟֆɛ ǟɮօʋɛ.
Ӈօաɛʋɛʀ, աɦɛռ ɖɛǟʟɨռɢ աɨȶɦ ǟ ɢɛռɛʀɨƈ ȶʏքɛ քǟʀǟʍɛȶɛʀ, ֆʊƈɦ ǟƈƈɛֆֆ ƈǟռ
օƈƈʊʀ ɨռɖɨʀɛƈȶʟʏ. ƐӼǟʍքʟɛֆ օʄ ֆʊƈɦ ɨռɖɨʀɛƈȶ ǟƈƈɛֆֆ ǟʀɛ:

- ɨռʋօӄɨռɢ ǟ ƈǟʟʟɮǟƈӄ,
- ʋɨǟ ǟ ȶʀǟɨȶ ʍɛȶɦօɖ ƈǟʟʟ.

(Ƒʊȶʊʀɛ ƈɦǟռɢɛֆ ȶօ ȶɦɛ ʟǟռɢʊǟɢɛ, ֆʊƈɦ ǟֆ ɨʍքʟ ֆքɛƈɨǟʟɨʐǟȶɨօռ, ʍǟʏ ǟɖɖ
օȶɦɛʀ ǟʋɛռʊɛֆ ʄօʀ ֆʊƈɦ ɨռɖɨʀɛƈȶ ǟƈƈɛֆֆ.)

Ӈɛʀɛ ɨֆ ǟռ ɛӼǟʍքʟɛ օʄ ɨռʋօӄɨռɢ ǟ ƈǟʟʟɮǟƈӄ:

```rust
struct Inspector<T>(T, &'static str, Box<for <'r> fn(&'r T) -> String>);

impl<T> Drop for Inspector<T> {
    fn drop(&mut self) {
        // The `self.2` call could access a borrow e.g. if `T` is `&'a _`.
        println!("Inspector({}, {}) unwittingly inspects expired data.",
                 (self.2)(&self.0), self.1);
    }
}
```

Ӈɛʀɛ ɨֆ ǟռ ɛӼǟʍքʟɛ օʄ ǟ ȶʀǟɨȶ ʍɛȶɦօɖ ƈǟʟʟ:

```rust
use std::fmt;

struct Inspector<T: fmt::Display>(T, &'static str);

impl<T: fmt::Display> Drop for Inspector<T> {
    fn drop(&mut self) {
        // There is a hidden call to `<T as Display>::fmt` below, which
        // could access a borrow e.g. if `T` is `&'a _`
        println!("Inspector({}, {}) unwittingly inspects expired data.",
                 self.0, self.1);
    }
}
```

Ǟռɖ օʄ ƈօʊʀֆɛ, ǟʟʟ օʄ ȶɦɛֆɛ ǟƈƈɛֆֆɛֆ ƈօʊʟɖ ɮɛ ʄʊʀȶɦɛʀ ɦɨɖɖɛռ աɨȶɦɨռ
ֆօʍɛ օȶɦɛʀ ʍɛȶɦօɖ ɨռʋօӄɛɖ ɮʏ ȶɦɛ ɖɛֆȶʀʊƈȶօʀ, ʀǟȶɦɛʀ ȶɦǟռ ɮɛɨռɢ աʀɨȶȶɛռ
ɖɨʀɛƈȶʟʏ աɨȶɦɨռ ɨȶ.

Ɨռ ǟʟʟ օʄ ȶɦɛ ǟɮօʋɛ ƈǟֆɛֆ աɦɛʀɛ ȶɦɛ `&'ǟ ʊ8` ɨֆ ǟƈƈɛֆֆɛɖ ɨռ ȶɦɛ
ɖɛֆȶʀʊƈȶօʀ, ǟɖɖɨռɢ ȶɦɛ `#[ʍǟʏ_ɖǟռɢʟɛ]`
ǟȶȶʀɨɮʊȶɛ ʍǟӄɛֆ ȶɦɛ ȶʏքɛ ʋʊʟռɛʀǟɮʟɛ ȶօ ʍɨֆʊֆɛ ȶɦǟȶ ȶɦɛ ɮօʀʀօա
ƈɦɛƈӄɛʀ աɨʟʟ ռօȶ ƈǟȶƈɦ, ɨռʋɨȶɨռɢ ɦǟʋօƈ. Ɨȶ ɨֆ ɮɛȶȶɛʀ ȶօ ǟʋօɨɖ ǟɖɖɨռɢ
ȶɦɛ ǟȶȶʀɨɮʊȶɛ.

## Ǟ ʀɛʟǟȶɛɖ ֆɨɖɛ ռօȶɛ ǟɮօʊȶ ɖʀօք օʀɖɛʀ

Ɯɦɨʟɛ ȶɦɛ ɖʀօք օʀɖɛʀ օʄ ʄɨɛʟɖֆ ɨռֆɨɖɛ ǟ ֆȶʀʊƈȶ ɨֆ ɖɛʄɨռɛɖ, ʀɛʟʏɨռɢ օռ ɨȶ ɨֆ
ʄʀǟɢɨʟɛ ǟռɖ ֆʊɮȶʟɛ. Ɯɦɛռ ȶɦɛ օʀɖɛʀ ʍǟȶȶɛʀֆ, ɨȶ ɨֆ ɮɛȶȶɛʀ ȶօ ʊֆɛ ȶɦɛ
[`ⱮǟռʊǟʟʟʏƉʀօք`] աʀǟքքɛʀ.

## Ɨֆ ȶɦǟȶ ǟʟʟ ǟɮօʊȶ ɖʀօք ƈɦɛƈӄɛʀ?

Ɨȶ ȶʊʀռֆ օʊȶ ȶɦǟȶ աɦɛռ աʀɨȶɨռɢ ʊռֆǟʄɛ ƈօɖɛ, աɛ ɢɛռɛʀǟʟʟʏ ɖօռ'ȶ ռɛɛɖ ȶօ
աօʀʀʏ ǟȶ ǟʟʟ ǟɮօʊȶ ɖօɨռɢ ȶɦɛ ʀɨɢɦȶ ȶɦɨռɢ ʄօʀ ȶɦɛ ɖʀօք ƈɦɛƈӄɛʀ. Ӈօաɛʋɛʀ ȶɦɛʀɛ
ɨֆ օռɛ ֆքɛƈɨǟʟ ƈǟֆɛ ȶɦǟȶ ʏօʊ ռɛɛɖ ȶօ աօʀʀʏ ǟɮօʊȶ, աɦɨƈɦ աɛ աɨʟʟ ʟօօӄ ǟȶ ɨռ
ȶɦɛ ռɛӼȶ ֆɛƈȶɨօռ.

[ʀʄƈ1327]: https://github.com/rust-lang/rfcs/blob/master/text/1327-dropck-param-eyepatch.md
[ʀʄƈ1857]: https://github.com/rust-lang/rfcs/blob/master/text/1857-stabilize-drop-order.md
[`ʍǟռʊǟʟʟʏɖʀօք`]: https://doc.rust-lang.org/std/mem/struct.ManuallyDrop.html
